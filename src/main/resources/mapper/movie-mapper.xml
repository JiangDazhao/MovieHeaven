<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cuhk.MovieHeaven.dao.MovieMapper">
    <sql id="selectFields">
        movie_id,user_id,title,genre,year,info,rating,post_time
    </sql>

    <sql id="insertFields">
        user_id,title,genre,year,info,post_time
    </sql>

    <select id="selectAllMovies" resultType="Movie">
        select <include refid="selectFields"></include>
        from movie
        limit #{offset}, #{limit}
    </select>

    <select id="selectMovieByMovieId" resultType="Movie">
        select <include refid="selectFields"></include>
        from movie
        where movie_id=#{movieId}
    </select>

    <select id="selectMovieByTitle" resultType="Movie">
        select <include refid="selectFields"></include>
        from movie
        where title=#{title}
    </select>

    <insert id="insertMovie" parameterType="Movie" keyProperty="movieId">
        insert into movie(<include refid="insertFields"></include>)
        values(#{userId},#{title},#{genre},#{year},#{info},#{postTime})
    </insert>

    <select id="selectMovieRows" resultType="int">
        select count(movie_id)
        from movie
    </select>

    <update id="updateRating">
        update movie set rating=#{rating} where movie_id=#{movieId}
    </update>
</mapper>